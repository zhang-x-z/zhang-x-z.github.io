<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/zhang.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/zhang16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-mac-osx.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="在最近的数据结构课上学习了双端优先队列（Double-ended Priority Queue）这一数据结构。简单来说双端优先队列是一种数据结构，它可以满足找最大值，找最小值，删除最大值喝删除最小值的操作，因为单端优先队列只能满足查找删除最大值或最小值，所以称这种数据结构为双端优先队列。 实现双端优先队列一个一般的想法就是同时维护数据的最大堆和最小堆，取最大最小值时只要在对应的最大堆或者最小堆取即">
<meta property="og:type" content="article">
<meta property="og:title" content="实现Double-ended Priority Queue的三种数据结构">
<meta property="og:url" content="http://yoursite.com/2020/06/01/%E5%AE%9E%E7%8E%B0Double-ended-Priority-Queue%E7%9A%84%E4%B8%89%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/index.html">
<meta property="og:site_name" content="🌵">
<meta property="og:description" content="在最近的数据结构课上学习了双端优先队列（Double-ended Priority Queue）这一数据结构。简单来说双端优先队列是一种数据结构，它可以满足找最大值，找最小值，删除最大值喝删除最小值的操作，因为单端优先队列只能满足查找删除最大值或最小值，所以称这种数据结构为双端优先队列。 实现双端优先队列一个一般的想法就是同时维护数据的最大堆和最小堆，取最大最小值时只要在对应的最大堆或者最小堆取即">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://gitee.com/z-x-z/pictures/raw/master/maxheap.png">
<meta property="og:image" content="https://gitee.com/z-x-z/pictures/raw/master/20200601132617.png">
<meta property="og:image" content="https://gitee.com/z-x-z/pictures/raw/master/20200601142442.png">
<meta property="og:image" content="https://gitee.com/z-x-z/pictures/raw/master/20200601142651.png">
<meta property="og:image" content="https://gitee.com/z-x-z/pictures/raw/master/20200601222744.png">
<meta property="article:published_time" content="2020-06-01T03:01:52.000Z">
<meta property="article:modified_time" content="2020-06-01T15:10:45.257Z">
<meta property="article:author" content="ZXZ">
<meta property="article:tag" content="数据结构">
<meta property="article:tag" content="堆">
<meta property="article:tag" content="优先队列">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://gitee.com/z-x-z/pictures/raw/master/maxheap.png">

<link rel="canonical" href="http://yoursite.com/2020/06/01/%E5%AE%9E%E7%8E%B0Double-ended-Priority-Queue%E7%9A%84%E4%B8%89%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>实现Double-ended Priority Queue的三种数据结构 | 🌵</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<link rel="alternate" href="/atom.xml" title="🌵" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">🌵</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Code the World</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/zhang-x-z" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2020/06/01/%E5%AE%9E%E7%8E%B0Double-ended-Priority-Queue%E7%9A%84%E4%B8%89%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="ZXZ">
      <meta itemprop="description" content="ZXZ's blog">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="🌵">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          实现Double-ended Priority Queue的三种数据结构
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2020-06-01 11:01:52 / 修改时间：23:10:45" itemprop="dateCreated datePublished" datetime="2020-06-01T11:01:52+08:00">2020-06-01</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" itemprop="url" rel="index"><span itemprop="name">数据结构</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>6.4k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>6 分钟</span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>在最近的数据结构课上学习了双端优先队列（Double-ended Priority Queue）这一数据结构。简单来说双端优先队列是一种数据结构，它可以满足找最大值，找最小值，删除最大值喝删除最小值的操作，因为单端优先队列只能满足查找删除最大值或最小值，所以称这种数据结构为双端优先队列。</p>
<p>实现双端优先队列一个一般的想法就是同时维护数据的最大堆和最小堆，取最大最小值时只要在对应的最大堆或者最小堆取即可。但删除的时候需要面临删除最小值时也要在最大堆删除掉相应的值，就要求我们的最大堆或最小堆支持删除任意节点的操作，同时还要支持查找任意节点的操作，这些都是很繁琐的。此外这种方法将每个数据都存放了两遍，造成了空间的浪费。</p>
<p>所以我们需要新的数据结构来帮我们更好的实现双端优先队列，在本文中我们介绍Min-Max Heap，DEAP以及Interval Heap三种数据结构。</p>
<a id="more"></a>

<p>我们首先来复习一下单端优先队列的实现，也就是最大堆和最小堆。</p>
<h2 id="最大堆-最小堆"><a href="#最大堆-最小堆" class="headerlink" title="最大堆/最小堆"></a>最大堆/最小堆</h2><p>最大堆是一棵完全二叉树，它要求根节点比两个孩子（如果存在的话）都要大，并且对于树中以每个节点为根的子树都要满足这个要求。最小堆只要满足比两个孩子都要小即可。如图为一个最大堆：</p>
<p><img src="https://gitee.com/z-x-z/pictures/raw/master/maxheap.png" alt=""></p>
<p>下面以最大堆为例，介绍插入删除以及初始化操作，最小堆同理。</p>
<h3 id="插入"><a href="#插入" class="headerlink" title="插入"></a>插入</h3><p>插入一个新节点，我们把新节点放在第一个有空位的叶子节点上。然后查看新插入的叶子节点和它的父节点，如果新节点比父节点小，说明符合定义，不必做额外操作，如果新节点比父节点大，则交换新节点与父节点，继续查看交换后的新节点和它的父节点，进行同样的操作，直到符合定义或者新节点被换到根节点。</p>
<h3 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h3><p>删除操作只允许删除最大值，最大值根据最大堆定义，即为根节点，直接删除根节点即可。同时将最后一个叶子节点放到根节点上，开始检查：找出新放上来的叶子节点的两个孩子中的最大值并交换，交换过后继续检查新放上来的叶子节点的两个孩子中的最大值，直到新放上来的叶子节点被交换到叶子上。</p>
<h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>初始化用最简单的想法就是初始化一棵空树，然后一个一个的插入现有数据，这样做的时间复杂度是$O(nlogn)$，我们还有一种更加高效的初始化方法。我们按照层序遍历的顺序，从倒数第二层开始遍历，对每个节点进行和删除操作中一样的从根节点向下检查的操作，遍历到根节点并操作完成后即可获得最大堆。</p>
<h2 id="Min-Max-Heap"><a href="#Min-Max-Heap" class="headerlink" title="Min-Max Heap"></a>Min-Max Heap</h2><p>Min-Max Heap也是一个完全二叉树，我们来看论文中的定义：</p>
<blockquote>
<p>Given a set S of values, a min-max heap on S is a binary tree T with the following properties: </p>
<p>1) T has the heap-shape </p>
<p>2) T is min-max ordered: values stored at nodes on even (odd) levels are smaller (greater) than or equal to the values stored at their descendants (if any) where the root is at level zero. Thus, the smallest value of S is stored at the root of T, whereas the largest value is stored at one of the root’s children;</p>
</blockquote>
<p>简单来说就是，在偶数层中的节点比所有的子孙节点都要小，在奇数层的节点比所有的子孙节点都要大。下面是一个例子</p>
<p><img src="https://gitee.com/z-x-z/pictures/raw/master/20200601132617.png" alt=""></p>
<h3 id="插入-1"><a href="#插入-1" class="headerlink" title="插入"></a>插入</h3><p>对于插入操作来说，我们定义这样一个流程，首先和最大堆最小堆一样，我们将新节点插入到第一个空的叶子节点上，然后对新插入的节点用BubbleUp操作，BubbleUp操作伪码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BubbleUp</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> A[i] <span class="keyword">in</span> Min level:</span><br><span class="line">        <span class="keyword">if</span> A[i] has parent <span class="keyword">and</span> A[parent(i)] &lt; A[i]:</span><br><span class="line">            swap A[i] <span class="keyword">and</span> A[parent(i)]</span><br><span class="line">            BubbleUpMax(parent(i))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            BubbleUpMin(i)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> A[i] has parent <span class="keyword">and</span> A[parent(i)] &gt; A[i]:</span><br><span class="line">            swap A[i] <span class="keyword">and</span> A[parent(i)]</span><br><span class="line">            BubbleUpMin(parent(i))</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            BubbleUpMax(i)</span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BubbleUpMin</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> A[i] has grandparent:</span><br><span class="line">        <span class="keyword">if</span> A[i] &lt; A[grandparent(i)]:</span><br><span class="line">            swap A[i] <span class="keyword">and</span> A[grandparent(i)]</span><br><span class="line">            BubbleUpMin(grandparent(i))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BubbleUpMax</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> A[i] has grandparent:</span><br><span class="line">        <span class="keyword">if</span> A[i] &gt; A[grandparent(i)]:</span><br><span class="line">            swap A[i] <span class="keyword">and</span> A[grandparent(i)]</span><br><span class="line">            BubbleUpMax(grandparent(i))</span><br></pre></td></tr></table></figure>

<h3 id="删除-1"><a href="#删除-1" class="headerlink" title="删除"></a>删除</h3><p>删除支持删除最大和删除最小，最小即为根节点，最大则是第二层中较大的那个，如果只有一个节点则直接删除变为空树即可，其他情况找到要删除的节点后进行删除，并将最后一个叶子节点放到被删除的节点的位置上，然后从此位置进行TrackDown操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">TrackDown</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> A[i] <span class="keyword">in</span> Min level:</span><br><span class="line">        TrackDownMin(i)</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> A[i] <span class="keyword">in</span> Max level:</span><br><span class="line">        TrackDownMax(i)</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">TrackDownMin</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> A[i] has children:</span><br><span class="line">        m = index of smallest of the children <span class="keyword">and</span> grandchildren (<span class="keyword">if</span> any) of A[i]</span><br><span class="line">        <span class="keyword">if</span> A[m] <span class="keyword">is</span> grandchildren of A[i]:</span><br><span class="line">            <span class="keyword">if</span> A[m] &lt; A[i]:</span><br><span class="line">                swap A[m] <span class="keyword">and</span> A[i]</span><br><span class="line">                <span class="keyword">if</span> A[m] &gt; A[parent(m)]:</span><br><span class="line">                    swap A[m] <span class="keyword">and</span> A[parent(m)]</span><br><span class="line">                TrackDownMin(m)</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> A[m] <span class="keyword">is</span> children of A[i]:</span><br><span class="line">            <span class="keyword">if</span> A[m] &lt; A[i]:</span><br><span class="line">                swap A[m] <span class="keyword">and</span> A[i]</span><br><span class="line">                </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">TrackDownMax</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> A[i] has children:</span><br><span class="line">        m = index of largest of the children <span class="keyword">and</span> grandchildren (<span class="keyword">if</span> any) of A[i]</span><br><span class="line">        <span class="keyword">if</span> A[m] <span class="keyword">is</span> grandchildren of A[i]:</span><br><span class="line">            <span class="keyword">if</span> A[m] &gt; A[i]:</span><br><span class="line">                swap A[m] <span class="keyword">and</span> A[i]</span><br><span class="line">                <span class="keyword">if</span> A[m] &lt; A[parent(m)]:</span><br><span class="line">                    swap A[m] <span class="keyword">and</span> A[parent(m)]</span><br><span class="line">                TrackDownMax(m)</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> A[m] <span class="keyword">is</span> children of A[i]:</span><br><span class="line">            <span class="keyword">if</span> A[m] &gt; A[i]:</span><br><span class="line">                swap A[m] <span class="keyword">and</span> A[i]</span><br></pre></td></tr></table></figure>

<h3 id="初始化-1"><a href="#初始化-1" class="headerlink" title="初始化"></a>初始化</h3><p>论文中并没有提出特别的初始化方法，所以我们认为初始化为初始化一个空的Min-Max Heap，并不断调用Insert。</p>
<h2 id="DEAP"><a href="#DEAP" class="headerlink" title="DEAP"></a>DEAP</h2><p>这里的DEAP是Double-ended heap的简称，它也是一个完全二叉树，但它的根节点永远是空的，具体定义见文章：</p>
<blockquote>
<p>A deap is an implicit data structure with much resemblance to a heap. It can be regarded as a heap with a never referred element at the root. The left subtree of the root is a minheap, a heap with the smaller element at the root, and the right is a maxheap, a heap with the largest element at the root. Any leaf in the minheap is also smaller than the corresponding leaf in the maxheap.</p>
</blockquote>
<p>如图为一个DEAP</p>
<p><img src="https://gitee.com/z-x-z/pictures/raw/master/20200601142442.png" alt=""></p>
<p>对于定义中的corresponding，只要将MaxHeap上下翻转和MinHeap相对即可找出，具体见图：</p>
<p><img src="https://gitee.com/z-x-z/pictures/raw/master/20200601142651.png" alt=""></p>
<p>图中下半部分即为MaxHeap，上半部分即为MinHeap，与叶子节点相连的即为对应的节点。</p>
<h3 id="插入-2"><a href="#插入-2" class="headerlink" title="插入"></a>插入</h3><p>插入时和最大堆的插入操作一样，将新元素插入到第一个空的叶节点上，不同的是要满足对应关系，需要进行调整，具体见伪码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Insert</span><span class="params">(x)</span>:</span></span><br><span class="line">    x_i = index of first free position</span><br><span class="line">    A[x_i] = x</span><br><span class="line">    <span class="keyword">if</span> the first free position <span class="keyword">in</span> MinHeap:</span><br><span class="line">        i = index of the corresponding element</span><br><span class="line">        <span class="keyword">if</span> A[x_i] &gt; A[i]:</span><br><span class="line">            swap A[i] <span class="keyword">and</span> A[x_i]</span><br><span class="line">            BubbleUpMax(i)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            BubbleUpMin(x_i)</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> the first position <span class="keyword">in</span> MaxHeap:</span><br><span class="line">        i = index of the corresponding element</span><br><span class="line">        <span class="keyword">if</span> A[x_i] &lt; A[i]:</span><br><span class="line">            swap A[i] <span class="keyword">and</span> A[x_i]</span><br><span class="line">            BubbleUpMin(i)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            BubbleUpMax(x_i)</span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BubbleUpMin</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> A[i] has parent:</span><br><span class="line">        <span class="keyword">if</span> A[i] &lt; A[parent(i)]:</span><br><span class="line">            swap A[i] <span class="keyword">and</span> A[parent(i)]</span><br><span class="line">            BubbleUpMin(parent(i))</span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">BubbleUpMax</span><span class="params">(i)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> A[i] has parent:</span><br><span class="line">        <span class="keyword">if</span> A[i] &gt; A[parent(i)]:</span><br><span class="line">            swap A[i] <span class="keyword">and</span> A[parent(i)]</span><br><span class="line">            BubbleUpMin(parent(i))</span><br></pre></td></tr></table></figure>

<h3 id="删除-2"><a href="#删除-2" class="headerlink" title="删除"></a>删除</h3><p>删除支持删除最大和删除最小，最小元素根据定义就在MinHeap的根节点，最大元素就在MaxHeap的根节点，此时删除的操作和最大最小堆的删除操作类似，具体见伪码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DeleteMin</span><span class="params">()</span>:</span></span><br><span class="line">    i = index of the smallest element</span><br><span class="line">    <span class="keyword">while</span> A[i] <span class="keyword">is</span> <span class="keyword">not</span> leaf:</span><br><span class="line">        m = index of smallest children of A[i]</span><br><span class="line">        swap A[i] <span class="keyword">and</span> A[m]</span><br><span class="line">        i = m</span><br><span class="line">    insert the last leaf to index i</span><br><span class="line">   </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DeleteMax</span><span class="params">()</span>:</span></span><br><span class="line">    i = index of the largest element</span><br><span class="line">    <span class="keyword">while</span> A[i] <span class="keyword">is</span> <span class="keyword">not</span> leaf:</span><br><span class="line">        m = index of largest children of A[i]</span><br><span class="line">        swap A[i] <span class="keyword">and</span> A[m]</span><br><span class="line">        i = m</span><br><span class="line">    insert the last leaf to index i</span><br></pre></td></tr></table></figure>

<h3 id="初始化-2"><a href="#初始化-2" class="headerlink" title="初始化"></a>初始化</h3><p>对于初始化我们可以初始化一个空的DEAP，并不断插入数据。论文中给出了一种方法，和普通的最大堆最小堆初始化方法类似，但其实我对论文中的初始化部分也没有理解的很明白，只能讲一下自己的理解。</p>
<p>首先我们一样是按照层序遍历的顺序遍历这个完全二叉树，对于遍历到的每个元素，我们执行删除操作，删除过后应该在相应的叶子节点留下一个空位，然后在这个空位执行插入刚才被我们删除了的元素的操作。具体见伪代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Creation</span><span class="params">(array A)</span>:</span></span><br><span class="line">    c = length of array A</span><br><span class="line">    <span class="keyword">while</span> c &gt;= <span class="number">2</span>:</span><br><span class="line">       	i = c</span><br><span class="line">        <span class="keyword">while</span> A[i] <span class="keyword">is</span> <span class="keyword">not</span> leaf:</span><br><span class="line">            m = index of the smallest children of A[i]</span><br><span class="line">        	swap A[i] <span class="keyword">and</span> A[m]</span><br><span class="line">            i = m</span><br><span class="line">        <span class="comment"># insert</span></span><br><span class="line">        <span class="keyword">if</span> A[i] <span class="keyword">in</span> MinHeap:</span><br><span class="line">        	o = index of the corresponding element</span><br><span class="line">        	<span class="keyword">if</span> A[i] &gt; A[o]:</span><br><span class="line">            	swap A[i] <span class="keyword">and</span> A[o]</span><br><span class="line">            	BubbleUpMax(o)</span><br><span class="line">        	<span class="keyword">else</span>:</span><br><span class="line">            	BubbleUpMin(i)</span><br><span class="line">   		<span class="keyword">else</span> <span class="keyword">if</span> A[i] <span class="keyword">in</span> MaxHeap:</span><br><span class="line">        	o = index of the corresponding element</span><br><span class="line">        	<span class="keyword">if</span> A[i] &lt; A[o]:</span><br><span class="line">            	swap A[i] <span class="keyword">and</span> A[o]</span><br><span class="line">            	BubbleUpMin(o)</span><br><span class="line">        	<span class="keyword">else</span>:</span><br><span class="line">            	BubbleUpMax(i)</span><br><span class="line">        c = c - <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p>这份伪码我根据我的理解写的，实验了几组用例是正确的，但不保证，所以建议取看论文原文（见Reference）。</p>
<h2 id="Interval-Heap"><a href="#Interval-Heap" class="headerlink" title="Interval Heap"></a>Interval Heap</h2><p>Interval Heap也是一个完全二叉树结构，但不同的是节点中存放的是一个区间，即两个元素，左侧的元素要小于右边的元素，表示一个区间。我们定义区间的大小关系为如果两个区间$A_1=[a_1,b_1],A_2=[a_2,b_2]$，$a_1\le a_2,b_1 \ge b_2$，则称为区间$A_1$包含$A_2$。对于Interval Heap，我们要求根节点包含两个孩子节点，并且对于以两个孩子为根的子树也要符合这个要求。</p>
<p>如图为一个Interval Heap:</p>
<p><img src="https://gitee.com/z-x-z/pictures/raw/master/20200601222744.png" alt=""></p>
<p>注意如果一个节点内只有一个元素$a$那么我们将这个元素的区间定义为$[a,a]$。同时我们可以发现，所有节点中左侧的元素构成最小堆，右侧的元素构成最大堆。</p>
<h3 id="插入-3"><a href="#插入-3" class="headerlink" title="插入"></a>插入</h3><p>插入的过程很容易理解。我们首先查看最后一个叶子节点，如果只有一个元素，我们将新插入的元素放到这个节点中，如果新节点比最后一个叶子节点中的元素小，那么让新元素在左侧，开始BubbleUpMin的操作，具体来说就是将此元素与父节点中的较小元素进行比较，如果父节点中较小的元素更小则符合要求，否则交换父节点中较小的元素与该元素，并对交换后的该元素继续进行BubbleUpMin操作。如果比最后一个叶子节点中的元素大，则执行BubbleUpMax操作，和BubbleUpMin操作类似，只想比较操作不同。</p>
<p>如果最后一个叶子节点满了，那么就插入到第一个空闲的叶子节点中，然后比较该节点与父节点中的两个元素，如果父节点的区间包含该元素，则符合条件。如果该元素比父节点的较小的元素小，则将该节点与父节点中的较小元素交换，然后进行BubbleUpMin，如果该元素比父节点较大的元素大，则交换该元素与父节点中的较大元素，并执行BubbleUpMax操作。</p>
<h3 id="删除-3"><a href="#删除-3" class="headerlink" title="删除"></a>删除</h3><p>最大最小元素就是根节点的右侧元素和左侧元素。如果只含有一个或两个元素，删除很简单，直接删除即可。对于多于两个元素的树，删除最小值后我们将最后一个叶子节点的左侧元素放到根节点的左侧，如果叶节点移动后变为空则删除此叶节点。然后调整Min Heap：找到该节点孩子中的最小值，交换孩子节点中的最小值与新放入的元素，然后对交换后的孩子节点进行检查，如果出现左侧比右侧大则交换左右侧元素，然后继续对左侧元素进行检查孩子节点并交换的操作，直到到叶子节点。对于删除最大也是类似的。</p>
<h3 id="初始化-3"><a href="#初始化-3" class="headerlink" title="初始化"></a>初始化</h3><p>同样我们也可以初始化一个空的结构然后一步步插入。此外我们也有类似初始化最大堆的初始化操作，我们按照层序遍历的顺序从后往前遍历，对于每个节点，我们首先检查是否有左侧比右侧大出现，如果有则交换，然后对以该节点为根的树的左侧的元素进行调整最小堆的操作，和删除操作中的一样，对于右侧的元素进行调整最大堆的操作。遍历完所有节点后即可。</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ol>
<li><p>Min-Max Heap: <a href="https://cglab.ca/~morin/teaching/5408/refs/minmax.pdf" target="_blank" rel="noopener">https://cglab.ca/~morin/teaching/5408/refs/minmax.pdf</a></p>
</li>
<li><p>DEAP:  <a href="http://liacs.leidenuniv.nl/~stefanovtp/courses/StudentenSeminarium/Papers/AL/DEAP.pdf" target="_blank" rel="noopener">http://liacs.leidenuniv.nl/~stefanovtp/courses/StudentenSeminarium/Papers/AL/DEAP.pdf</a></p>
</li>
<li><p>Interval Heap <a href="https://www.cs.cmu.edu/~ckingsf/bioinfo-lectures/intervaltrees.pdf" target="_blank" rel="noopener">https://www.cs.cmu.edu/~ckingsf/bioinfo-lectures/intervaltrees.pdf</a></p>
</li>
</ol>

    </div>

    
    
    
        

  <div class="followme">
    <p>欢迎关注我的其它发布渠道</p>

    <div class="social-list">

        <div class="social-item">
          <a target="_blank" class="social-link" href="https://zhang-x-z.github.io">
            <span class="icon">
              <i class="fab fa-github"></i>
            </span>

            <span class="label">Github</span>
          </a>
        </div>

        <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
        </div>
    </div>
  </div>


      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag"># 数据结构</a>
              <a href="/tags/%E5%A0%86/" rel="tag"># 堆</a>
              <a href="/tags/%E4%BC%98%E5%85%88%E9%98%9F%E5%88%97/" rel="tag"># 优先队列</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/04/24/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E5%9C%A8Windows%E4%B8%8B%E4%BD%BF%E7%94%A8Linux/" rel="prev" title="如何优雅的在Windows下使用Linux">
      <i class="fa fa-chevron-left"></i> 如何优雅的在Windows下使用Linux
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#最大堆-最小堆"><span class="nav-number">1.</span> <span class="nav-text">最大堆&#x2F;最小堆</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#插入"><span class="nav-number">1.1.</span> <span class="nav-text">插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除"><span class="nav-number">1.2.</span> <span class="nav-text">删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始化"><span class="nav-number">1.3.</span> <span class="nav-text">初始化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Min-Max-Heap"><span class="nav-number">2.</span> <span class="nav-text">Min-Max Heap</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#插入-1"><span class="nav-number">2.1.</span> <span class="nav-text">插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除-1"><span class="nav-number">2.2.</span> <span class="nav-text">删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始化-1"><span class="nav-number">2.3.</span> <span class="nav-text">初始化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DEAP"><span class="nav-number">3.</span> <span class="nav-text">DEAP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#插入-2"><span class="nav-number">3.1.</span> <span class="nav-text">插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除-2"><span class="nav-number">3.2.</span> <span class="nav-text">删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始化-2"><span class="nav-number">3.3.</span> <span class="nav-text">初始化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Interval-Heap"><span class="nav-number">4.</span> <span class="nav-text">Interval Heap</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#插入-3"><span class="nav-number">4.1.</span> <span class="nav-text">插入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#删除-3"><span class="nav-number">4.2.</span> <span class="nav-text">删除</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始化-3"><span class="nav-number">4.3.</span> <span class="nav-text">初始化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">5.</span> <span class="nav-text">Reference</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="ZXZ"
      src="/images/header.jpg">
  <p class="site-author-name" itemprop="name">ZXZ</p>
  <div class="site-description" itemprop="description">ZXZ's blog</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">3</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/zhang-x-z" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;zhang-x-z" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/atom.xml" title="RSS → &#x2F;atom.xml"><i class="fa fa-rss fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/fade-89-81" title="zhihu → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;fade-89-81" rel="noopener" target="_blank"><i class="fab fa-zhihu fa-fw"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZXZ</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">10k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">9 分钟</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
